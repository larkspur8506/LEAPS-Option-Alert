{% extends "base.html" %}

{% block title %}规则配置{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="flex justify-between items-center mb-8">
        <h1 class="text-3xl font-bold text-gray-800">规则配置</h1>
        <a href="/admin" class="text-blue-600 hover:text-blue-800">返回 Dashboard</a>
    </div>

    <form action="/admin/rules" method="post" class="space-y-8">
        <!-- QQQ 入场规则 (新版 Level 1/2/3) -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">🟢 QQQ 入场规则</h2>
            <p class="text-gray-600 mb-4">启用或禁用分级入场提醒规则</p>

            <div class="space-y-3">
                <label class="flex items-center">
                    <input type="checkbox" name="entry_level1_enabled" {% if config.entry_level1_enabled %}checked{%
                        endif %} class="mr-2">
                    <span class="text-gray-700"><strong>Level 1 (日常回调):</strong> 跌幅 ≥ 1.2% 且触碰 MA20</span>
                </label>

                <label class="flex items-center">
                    <input type="checkbox" name="entry_level2_enabled" {% if config.entry_level2_enabled %}checked{%
                        endif %} class="mr-2">
                    <span class="text-gray-700"><strong>Level 2 (黄金坑):</strong> 3日累计跌幅 ≥ 3.5% 且 RSI &lt; 32</span>
                </label>

                <label class="flex items-center">
                    <input type="checkbox" name="entry_level3_enabled" {% if config.entry_level3_enabled %}checked{%
                        endif %} class="mr-2">
                    <span class="text-gray-700"><strong>Level 3 (极端超卖):</strong> 价格跌破布林下轨</span>
                </label>
            </div>
        </div>

        <!-- 期权止盈规则 -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">🎯 期权止盈规则</h2>
            <p class="text-gray-600 mb-4">启用或禁用多维止盈提醒</p>

            <div class="space-y-3">
                <label class="flex items-center">
                    <input type="checkbox" name="exit_hard_tp_enabled" {% if config.exit_hard_tp_enabled %}checked{%
                        endif %} class="mr-2">
                    <span class="text-gray-700"><strong>🎯 阶梯止盈:</strong> 4个月(50%) / 5-6个月(30%) / 7个月+(10%)</span>
                </label>

                <label class="flex items-center">
                    <input type="checkbox" name="exit_fast_tp_enabled" {% if config.exit_fast_tp_enabled %}checked{%
                        endif %} class="mr-2">
                    <span class="text-gray-700"><strong>🚀 极速止盈:</strong> 持仓 ≤ 7天且盈利达到 15%</span>
                </label>

                <label class="flex items-center">
                    <input type="checkbox" name="exit_trailing_tp_enabled" {% if config.exit_trailing_tp_enabled
                        %}checked{% endif %} class="mr-2">
                    <span class="text-gray-700"><strong>📉 移动止盈:</strong> 最高收益 &gt; 30% 后回撤超过 10%</span>
                </label>

                <label class="flex items-center">
                    <input type="checkbox" name="exit_tech_tp_enabled" {% if config.exit_tech_tp_enabled %}checked{%
                        endif %} class="mr-2">
                    <span class="text-gray-700"><strong>⚠️ 技术止盈:</strong> QQQ RSI &gt; 75 或突破布林上轨</span>
                </label>
            </div>
        </div>

        <!-- 期权风控规则 -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">🛡️ 期权风控规则</h2>
            <p class="text-gray-600 mb-4">启用或禁用时间和趋势风控提醒</p>

            <div class="space-y-3">
                <label class="flex items-center">
                    <input type="checkbox" name="exit_dte_warning_enabled" {% if config.exit_dte_warning_enabled
                        %}checked{% endif %} class="mr-2">
                    <span class="text-gray-700"><strong>⏳ 移仓窗口:</strong> DTE &lt; 120 天提醒</span>
                </label>

                <label class="flex items-center">
                    <input type="checkbox" name="exit_dte_force_enabled" {% if config.exit_dte_force_enabled %}checked{%
                        endif %} class="mr-2">
                    <span class="text-gray-700"><strong>⛔ 强制清仓:</strong> DTE &lt; 90 天提醒</span>
                </label>

                <label class="flex items-center">
                    <input type="checkbox" name="exit_trend_stop_enabled" {% if config.exit_trend_stop_enabled
                        %}checked{% endif %} class="mr-2">
                    <span class="text-gray-700"><strong>🛑 趋势崩坏:</strong> QQQ 有效跌破 MA200</span>
                </label>
            </div>
        </div>

        <div class="flex justify-end mt-8">
            <button type="submit"
                class="bg-blue-600 text-white py-2 px-8 rounded-md hover:bg-blue-700 transition font-bold shadow-lg">
                保存配置
            </button>
        </div>
    </form>
</div>
{% endblock %}